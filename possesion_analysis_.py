# -*- coding: utf-8 -*-
"""possesion analysis .ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1iHGFfHyO4f7v0XyJvkGjtvA1RQqnc3Bv
"""

import pandas as pd

df=pd.read_csv('3YEAR_without_dummies.csv')

df.info()

BAZIGAR_TEAM=df[( (df['HomePos']+10 < df['AwayPos']) & (df['HomePass'] < df['AwayPass']) & (df['FTR']=='H') ) | 
                  ((df['AwayPos']+10 < df['HomePos'])& (df['HomePass'] < df['AwayPass']) & (df['FTR']=='A')) ]

newcastle=BAZIGAR_TEAM[((BAZIGAR_TEAM['HomeTeam']=='Newcastle') & (df['FTR']=='H'))  | ((BAZIGAR_TEAM['AwayTeam']=='Man United') & (df['FTR']=='A'))]

newcastle

BAZIGAR_TEAM1=df[( (df['HomePos'] < df['AwayPos']) & (df['HomePass'] < df['AwayPass']) & (df['FTR']=='H') ) | 
                  ((df['AwayPos'] < df['HomePos'])& (df['HomePass'] < df['AwayPass']) & (df['FTR']=='A')) ]

BAZIGAR_TEAM1.AwayTeam.value_counts()

home=BAZIGAR_TEAM1[BAZIGAR_TEAM1['HomeTeam']=='Newcastle']

home

newcastle1=BAZIGAR_TEAM1[((BAZIGAR_TEAM1['HomeTeam']=='Newcastle') & (df['FTR']=='A'))  | ((BAZIGAR_TEAM1['AwayTeam']=='Newcastle') & (df['FTR']=='A'))]

newcastle1

377/1148

"""when the differnce is more than 10"""

BAZIGAR_TEAM_pro=df[((df['HomePos'] < df['AwayPos']-15) & (df['FTR']=='H') ) | 
                  ((df['AwayPos'] < df['HomePos']-15) & (df['FTR']=='A')) ]

BAZIGAR_TEAM_pro

1148/216

BAZIGAR_TEAM_Everton_Liverpool=df[( (df['HomePos'] < df['AwayPos']) & (df['HomePass'] < df['AwayPass']) & (df['FTR']=='H') ) | 
                  ((df['AwayPos'] < df['HomePos'])& (df['HomePass'] < df['AwayPass']) & (df['FTR']=='A')) ]

everpool=BAZIGAR_TEAM[((BAZIGAR_TEAM_Everton_Liverpool['HomeTeam']=='Everton') & (df['FTR']=='H'))  | ((BAZIGAR_TEAM_Everton_Liverpool['AwayTeam']=='Liverpool') & (df['FTR']=='A'))]

everpool

home=BAZIGAR_TEAM1[BAZIGAR_TEAM1['HomeTeam']=='Everton']

home

